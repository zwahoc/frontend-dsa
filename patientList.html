<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient List</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="d-flex flex-column min-vh-100 font-dmSans">

    <!-- Header -->
    <div class="sticky-top bg-white font-dmSans">
        <nav class="content-wrapper" style="margin: 0px auto !important;">
            <div class="py-4 d-flex flex-row justify-content-between align-items-center">

                <div class="d-flex align-items-center justify-content-start text-primary-500 text-xl fw-bolder">
                    TARUMT Clinic
                </div>

                <div class="d-flex align-items-center">
                    <ul class="nav d-flex flex-row justify-content-end gap-4 fw-semibold">
                        <li class="hover-nav user-select-none">
                            Home
                        </li>
                        <li class="hover-nav user-select-none">
                            Doctors
                        </li>
                        <li class="hover-nav user-select-none">
                            Book Patient
                        </li>
                        <li class="hover-nav user-select-none">
                            Online Queue
                        </li>
                        <li class="hover-nav user-select-none">
                            Login as Staff
                        </li>
                    </ul>
                </div>

            </div>
        </nav>
    </div>

    <!-- Main Content Area -->
    <div class="container-fluid content-wrapper" style="margin: 0px auto !important;">
        <div class="row">
            <!-- Main Content Area -->
            <div class="p-4">
                <!-- Header with title -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="m-0 fw-bolder">Patient List</h3>
                    <div class="d-flex align-items-center">
                        <div class="input-group me-2" style="width: 300px;">
                            <span class="input-group-text bg-light border-end-0">
                                <i class="fa-solid fa-magnifying-glass"></i>
                            </span>
                            <input type="text" class="form-control bg-light border-start-0" id="search-input"
                                placeholder="Search patients...">
                        </div>
                        <button class="btn btn-outline-secondary" type="button" id="filterModalBtn">
                            <i class="fa-solid fa-filter"></i>
                        </button>
                    </div>
                </div>

                <!-- Patient Rows -->
                <div class="card shadow-sm rounded mb-4">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th scope="col">Patient Name</th>
                                    <th scope="col">Student ID</th>
                                    <th scope="col">Age</th>
                                    <th scope="col">Gender</th>
                                    <th scope="col">Last Visit</th>
                                    <th scope="col">Status</th>
                                    <th scope="col">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Patient 1 -->
                                <tr class="patient-row">
                                    <td class="align-middle">
                                        <div class="d-flex align-items-center">
                                            <h6 class="mb-0">John Johnson</h6>
                                        </div>
                                    </td>
                                    <td class="align-middle" id="studentID">25WMR09920</td>
                                    <td class="align-middle" id="age">20</td>
                                    <td class="align-middle" id="gender">Male</td>
                                    <td class="align-middle" id="lastVisit">2025-07-13</td>
                                    <td class="align-middle" id="status"><span class="badge bg-success">Scheduled</span>
                                    </td>
                                    <td class="align-middle">
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-info">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Edit</button>
                                        </div>
                                    </td>
                                </tr>

                                <!-- Patient 1 -->
                                <tr class="patient-row">
                                    <td class="align-middle">
                                        <div class="d-flex align-items-center">
                                            <h6 class="mb-0">John Johnson</h6>
                                        </div>
                                    </td>
                                    <td class="align-middle" id="studentID">25WMR09920</td>
                                    <td class="align-middle" id="age">20</td>
                                    <td class="align-middle" id="gender">Male</td>
                                    <td class="align-middle" id="lastVisit">2025-07-13</td>
                                    <td class="align-middle" id="status"><span class="badge bg-success">Scheduled</span>
                                    </td>
                                    <td class="align-middle">
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-info">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Edit</button>
                                        </div>
                                    </td>
                                </tr>

                                <!-- Patient 1 -->
                                <tr class="patient-row">
                                    <td class="align-middle">
                                        <div class="d-flex align-items-center">
                                            <h6 class="mb-0">John Johnson</h6>
                                        </div>
                                    </td>
                                    <td class="align-middle" id="studentID">25WMR09920</td>
                                    <td class="align-middle" id="age">20</td>
                                    <td class="align-middle" id="gender">Female</td>
                                    <td class="align-middle" id="lastVisit">2025-07-13</td>
                                    <td class="align-middle" id="status"><span class="badge bg-success">Scheduled</span>
                                    </td>
                                    <td class="align-middle">
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-info">View</button>
                                            <button class="btn btn-sm btn-outline-secondary">Edit</button>
                                        </div>
                                    </td>
                                </tr>


                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pagination -->
                <nav aria-label="Patient list pagination">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                            <a class="page-link" href="#">Next</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>

    <!-- Backdrop -->
    <div id="customBackdrop" class="position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50 d-none"
        style="z-index: 1050;"></div>

    <!-- Filter Modal -->
    <div id="filterModal"
        class="modal-animate position-fixed top-50 start-50 translate-middle bg-white shadow rounded p-4 d-none"
        style="z-index: 1051; width: 100%; max-width: 500px;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-bold mb-0">
                <i class="fa-solid fa-filter me-2"></i>Filter Patients
            </h5>
            <button type="button" class="btn-close" id="closeModalBtn" aria-label="Close"></button>
        </div>

        <form id="filter-form">
            <div class="mb-3">
                <label for="filter-gender" class="form-label">Gender</label>
                <select class="form-select" id="filter-gender">
                    <option selected>All Gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Last Visit Range</label>
                <div class="d-flex gap-2">
                    <input type="date" class="form-control" id="filter-visit-from">
                    <input type="date" class="form-control" id="filter-visit-to">
                </div>
            </div>

            <div class="mb-3">
                <label for="filter-status" class="form-label">Status</label>
                <select class="form-select" id="filter-status">
                    <option selected>All Statuses</option>
                    <option value="scheduled">Scheduled</option>
                    <option value="pending">Pending</option>
                    <option value="cancelled">Cancelled</option>
                    <option value="completed">Completed</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="filter-frequency" class="form-label">Frequency of Visits (more than)</label>
                <input type="number" class="form-control" min="0" id="filter-frequency" placeholder="e.g., 2">
            </div>

            <div class="d-flex justify-content-end gap-2">

                <button type="button"
                    class="border border-primary-subtle cancel-button user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 w-fit bg-white"
                    id="cancelModalBtn">
                    Close
                </button>
                <button type="button"
                    class="border border-primary-subtle reset-button user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 w-fit bg-white"
                    id="resetFiltersBtn">
                    Reset
                </button>
                <button type="button"
                    class="border border-primary-subtle user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 hover-button w-fit bg-white"
                    id="applyFiltersBtn">
                    Apply Filters
                </button>

            </div>
        </form>
    </div>

    <!-- View Modal -->
    <div id="viewModal"
        class="modal-animate position-fixed top-50 start-50 translate-middle bg-white shadow rounded p-4 d-none"
        style="z-index: 1051; width: 100%; max-width: 800px;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-bold mb-0 text-primary-500">
                <i class="fa-solid fa-user me-2"></i><span>Patient Details</span>
            </h5>
            <button type="button" class="btn-close" id="closeModalBtn" aria-label="Close"></button>
        </div>

        <div>
            <div class="mb-2 row">
                <div class="col"><strong>Student ID:</strong> <span id="viewStudentID">25WMR09920</span></div>
                <div class="col"><strong>Patient Name:</strong> <span id="viewUsername">Jeremy Chin Jun Chen</span>
                </div>
            </div>
            <div class="mb-2 row">
                <div class="col"><strong>Age:</strong> <span id="viewAge">20</span></div>
                <div class="col"><strong>Date of Birth:</strong> <span id="viewDOB">20-10-2005</span></div>

            </div>
            <div class="mb-2 row">
                <div class="col"><strong>Gender:</strong> <span id="viewGender">Male</span></div>
                <div class="col"><strong>Email:</strong> <span id="viewEmail">chinjunchen@gmail.com</span></div>
            </div>
            <div class="mb-2 row">
                <div class="col"><strong>Contact No:</strong> <span id="viewContactNo">60124210482</span></div>
                <div class="col"><strong>Emergency Contact No:</strong> <span
                        id="viewEmergencyContactNo">60122599763</span></div>
            </div>
        </div>

        <!-- Upcoming Appointments -->
        <div class="d-flex flex-column mt-4 pe-3">
            <h6 class="fw-bolder text-xl mb-3">Upcoming Appointments</h6>

            <div class="d-flex flex-column gap-3">
                <div class="d-flex flex-row justify-content-between align-items-center p-3 border rounded">
                    <div>
                        <strong>Appointment Date:</strong> 2025-07-13<br>
                        <strong>Time:</strong> 10.00 am<br>
                        <strong>Doctor:</strong> Dr. Jane Smith
                    </div>
                </div>
            </div>
        </div>

        <!-- Past Consultations -->
        <div class="d-flex flex-column mt-4 pe-3">
            <h6 class="fw-bolder text-xl mb-3">Past Consultations</h6>

            <div class="d-flex flex-column gap-3 pt-1" style="max-height: 120px; overflow-y: auto;">
                <div class="d-flex flex-row justify-content-between align-items-center p-3 border rounded mb-2">
                    <div>
                        <strong>Consultation Date:</strong> 2025-07-13<br>
                        <strong>Doctor:</strong> Dr. Jane Smith<br>
                        <strong>Diagnosis:</strong> Cough.
                    </div>
                    <button
                        class="viewDetailsBtn border border-primary-subtle user-select-none rounded-2 text-primary-500 text-decoration-none p-1 px-4 hover-button w-fit bg-white text-sm">View
                        Details</button>
                </div>

                <div class="d-flex flex-row justify-content-between align-items-center p-3 border rounded mb-2">
                    <div>
                        <strong>Consultation Date:</strong> 2025-06-20<br>
                        <strong>Doctor:</strong> Dr. John Doe<br>
                        <strong>Diagnosis:</strong> Fever.
                    </div>
                    <button
                        class="viewDetailsBtn border border-primary-subtle user-select-none rounded-2 text-primary-500 text-decoration-none p-1 px-4 hover-button w-fit bg-white text-sm">View
                        Details</button>
                </div>

                <div class="d-flex flex-row justify-content-between align-items-center p-3 border rounded mb-2">
                    <div>
                        <strong>Consultation Date:</strong> 2025-06-20<br>
                        <strong>Doctor:</strong> Dr. John Doe<br>
                        <strong>Diagnosis:</strong> Fever.
                    </div>
                    <button
                        class="viewDetailsBtn border border-primary-subtle user-select-none rounded-2 text-primary-500 text-decoration-none p-1 px-4 hover-button w-fit bg-white text-sm">View
                        Details</button>
                </div>
            </div>
        </div>



        <div class="text-end mt-4">
            <button type="button"
                class="border border-primary-subtle cancel-button user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 w-fit bg-white"
                id="closeViewBtn">
                Close
            </button>
        </div>
    </div>

    <!-- Past Consultation Details Modal -->
    <div id="consultationModal"
        class="modal-animate position-fixed top-50 start-50 translate-middle bg-white shadow rounded p-4 d-none"
        style="z-index: 1051; width: 100%; max-width: 800px; max-height: 700px; overflow-y: auto;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-bold mb-0 text-primary-500">
                <i class="fa-solid fa-file me-2"></i><span>Consultation Details</span>
            </h5>
            <button type="button" class="btn-close" id="closeModalBtn" aria-label="Close"></button>
        </div>

        <div class="pe-4" style="width: 100%; max-height: 500px; overflow-y: auto; overflow-x: hidden;">
            <div class="mb-2 row">
                <div class="col"><strong>Student ID:</strong> <span id="viewStudentID">25WMR09920</span></div>
                <div class="col"><strong>Patient:</strong> <span id="viewUsername">Jeremy Chin Jun Chen</span></div>
            </div>
            <div class="mb-4 row">
                <div class="col"><strong>Doctor:</strong> <span id="viewDoctor">Dr. John Doe</span></div>
                <div class="col"><strong>Consultation Date:</strong> <span id="viewConsultationDate">20-10-2024</span>
                </div>

            </div>
            <div class="mb-4 col">

                <div class="mb-2 col">
                    <div class="col"><strong>Symptoms: </strong></div>
                    <div class="col mb-2">
                        <div class="lineClamp-5 text-justify"><span id="viewSymptoms">Patient has a high fever and
                                cough. Patient has
                                a high fever and cough. Patient has a high fever and cough. Patient has a high fever and
                                cough. Patient has a high fever and cough. Patient has a high fever and cough. Patient
                                has a high fever and cough. Patient has a high fever and cough. Patient has a high fever
                                and cough. Patient has a high fever and cough. Patient has a high fever and cough.
                                Patient has a high fever and cough.Patient has a high fever and cough.Patient has a high
                                fever and cough. Patient has a high fever and cough.Patient has a high fever and
                                cough.Patient has a high fever and cough.Patient has a high fever and cough.Patient has
                                a high fever and cough.</span></div>
                    </div>
                </div>

            </div>

            <div class="mb-4 col"><strong>Diagnosis:</strong> <span id="viewDiagnosis">Fever</span></div>

            <div class="mb-2 col">
                <div class="col"><strong>Treatment Given: </strong></div>
                <div class="row">
                    <div class="lineClamp-5 text-justify"><span id="viewTreatment">Patient has been prescribed rest and
                            fluids.
                            Patient has been prescribed rest and fluids. Patient has been prescribed rest and
                            fluids. Patient has been prescribed rest and fluids. Patient has been prescribed rest
                            and fluids. Patient has been prescribed rest and fluids. Patient has been prescribed
                            rest and fluids. Patient has been prescribed rest and fluids. Patient has been
                            prescribed rest and fluids. Patient has been prescribed rest and fluids. Patient has
                            been prescribed rest and fluids. Patient has been prescribed rest and fluids. Patient
                            has been prescribed rest and fluids. Patient has been prescribed rest and fluids.</span>
                    </div>
                </div>
            </div>




        </div>
        <div class="text-end mt-4">
            <button type="button"
                class="border border-primary-subtle cancel-button user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 w-fit bg-white"
                id="closeConsultationBtn">
                Close
            </button>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal"
        class="modal-animate position-fixed top-50 start-50 translate-middle bg-white shadow rounded p-4 d-none"
        style="z-index: 1051; width: 100%; max-width: 800px;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-bold mb-0 text-primary-500">
                <i class="fa-solid fa-user me-2"></i><span>Edit Patient Details</span>
            </h5>
            <button type="button" class="btn-close" id="closeModalBtn" aria-label="Close"></button>
        </div>

        <form id="editPatientForm">
            <div class="mb-2 row">
                <div class="col">
                    <label class="form-label"><strong>Student ID:</strong></label>
                    <input type="text" class="form-control" id="editStudentID" value="25WMR09920" readonly>
                </div>
                <div class="col">
                    <label for="editUsername" class="form-label"><strong>Patient Name:</strong></label>
                    <input type="text" class="form-control" id="editUsername" value="Jeremy Chin Jun Chen" required>
                </div>
            </div>

            <div class="mb-2 row">
                <div class="col">
                    <label for="editAge" class="form-label"><strong>Age:</strong></label>
                    <input type="number" class="form-control" id="editAge" value="20" min="0" required>
                </div>
                <div class="col">
                    <label for="editDOB" class="form-label"><strong>Date of Birth:</strong></label>
                    <input type="date" class="form-control" id="editDOB" value="2005-10-20" required>
                </div>
            </div>

            <div class="mb-2 row">
                <div class="col">
                    <label for="editGender" class="form-label"><strong>Gender:</strong></label>
                    <select class="form-select" id="editGender" required>
                        <option value="Male" selected>Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="col">
                    <label for="editEmail" class="form-label"><strong>Email:</strong></label>
                    <input type="email" class="form-control" id="editEmail" value="chinjunchen@gmail.com" required>
                </div>
            </div>

            <div class="mb-2 row">
                <div class="col">
                    <label for="editContactNo" class="form-label"><strong>Contact No:</strong></label>
                    <input type="tel" class="form-control" id="editContactNo" value="60124210482" required>
                </div>
                <div class="col">
                    <label for="editEmergencyContactNo" class="form-label"><strong>Emergency Contact
                            No:</strong></label>
                    <input type="tel" class="form-control" id="editEmergencyContactNo" value="60122599763" required>
                </div>
            </div>

            <div class="text-end mt-4">
                <button type="button"
                    class="border border-primary-subtle cancel-button user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 bg-white me-2"
                    id="closeEditBtn">Cancel</button>

                <button type="button"
                    class="border border-primary-subtle user-select-none rounded-2 text-primary-500 text-decoration-none p-2 px-4 hover-button w-fit bg-white"
                    id="saveDetailsBtn">
                    Save Details
                </button>
            </div>
        </form>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const rowsPerPage = 8;
        let currentPage = 1;

        function paginatePatientRows(visibleRows = null) {
            const allRows = document.querySelectorAll('.patient-row');
            const rows = visibleRows || Array.from(allRows).filter(row => row.style.display !== 'none');
            const totalRows = rows.length;
            const totalPages = Math.ceil(totalRows / rowsPerPage);

            rows.forEach((row, index) => {
                row.style.display = (index >= (currentPage - 1) * rowsPerPage && index < currentPage * rowsPerPage)
                    ? ''
                    : 'none';
            });

            const paginationContainer = document.querySelector('.pagination');
            paginationContainer.innerHTML = '';

            paginationContainer.appendChild(createPaginationItem('Previous', currentPage > 1, () => {
                if (currentPage > 1) {
                    currentPage--;
                    paginatePatientRows(rows);
                }
            }));

            for (let i = 1; i <= totalPages; i++) {
                paginationContainer.appendChild(createPaginationItem(i, true, () => {
                    currentPage = i;
                    paginatePatientRows(rows);
                }, currentPage === i));
            }

            paginationContainer.appendChild(createPaginationItem('Next', currentPage < totalPages, () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    paginatePatientRows(rows);
                }
            }));
        }

        function createPaginationItem(label, enabled, onClick, isActive = false) {
            const li = document.createElement('li');
            li.className = 'page-item' + (enabled ? '' : ' disabled') + (isActive ? ' active' : '');

            const a = document.createElement('a');
            a.className = 'page-link';
            a.href = '#';
            a.textContent = label;

            if (enabled) {
                a.addEventListener('click', (e) => {
                    e.preventDefault();
                    onClick();
                });
            }

            li.appendChild(a);
            return li;
        }

        // Run on page load
        document.addEventListener('DOMContentLoaded', () => {
            paginatePatientRows();
        });
        // Search functionality
        document.getElementById('search-input').addEventListener('keyup', function (event) {
            if (event.key === 'Enter') {
                performSearch();
            } else {
                performSearch(); // Real-time search
            }
        });

        function performSearch() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const patientRows = document.querySelectorAll('.patient-row');

            let visibleRows = [];

            patientRows.forEach(row => {
                const patientInfo = row.textContent.toLowerCase();
                const match = patientInfo.includes(searchTerm);
                row.style.display = match ? '' : 'none';
                if (match) visibleRows.push(row);
            });

            currentPage = 1;
            paginatePatientRows(visibleRows);
        }


        const viewModal = document.getElementById('viewModal');
        const editModal = document.getElementById('editModal');
        const consultationModal = document.getElementById('consultationModal');
        const filterModal = document.getElementById('filterModal');
        const customBackdrop = document.getElementById('customBackdrop');

        const closeModal = () => {
            closeModalAnimated(viewModal);
            closeModalAnimated(editModal);
            closeModalAnimated(consultationModal);
            closeModalAnimated(filterModal);
        };

        const openFilterModal = () => {
            openModalAnimated(filterModal);
        };

        filterModalBtn.addEventListener('click', openFilterModal);
        document.getElementById('closeModalBtn').addEventListener('click', closeModal);
        document.getElementById('cancelModalBtn').addEventListener('click', closeModal);
        customBackdrop.addEventListener('click', closeModal);

        // Filter functions
        // Apply Filters and close
        document.getElementById('applyFiltersBtn').addEventListener('click', () => {
            applyFilters(); // your existing function
            closeModal();
        });

        // Reset filters
        document.getElementById('resetFiltersBtn').addEventListener('click', () => {
            resetFilters(); // your existing function
            closeModal();
        });

        // Close buttons (they all use same ID, so select all of them)
        document.querySelectorAll('#closeModalBtn').forEach(btn => {
            btn.addEventListener('click', () => {
                closeModalAnimated(viewModal);
                closeModalAnimated(editModal);
                closeModalAnimated(consultationModal);
                closeModalAnimated(filterModal);
            });
        });

        // Specific close buttons
        document.getElementById('closeViewBtn').addEventListener('click', () => {
            closeModalAnimated(viewModal);
        });

        document.getElementById('closeEditBtn').addEventListener('click', () => {
            closeModalAnimated(editModal);
        });

        document.getElementById('closeConsultationBtn').addEventListener('click', () => {
            closeModalAnimated(consultationModal);
        });

        // Open View or Edit Modal
        document.querySelectorAll('.patient-row').forEach(row => {
            const name = row.querySelector('td:nth-child(1)').innerText.trim();
            const studentID = row.querySelector('td:nth-child(2)').innerText.trim();
            const age = row.querySelector('td:nth-child(3)').innerText.trim();
            const gender = row.querySelector('td:nth-child(4)').innerText.trim();

            const viewBtn = row.querySelector('.btn-outline-info');
            const editBtn = row.querySelector('.btn-outline-secondary');

            // View Button
            viewBtn.addEventListener('click', () => {
                // Fill view modal with dummy data (replace with actual fetch if needed)
                document.getElementById('viewStudentID').textContent = studentID;
                document.getElementById('viewUsername').textContent = name;
                document.getElementById('viewAge').textContent = age;
                document.getElementById('viewDOB').textContent = '2005-10-20'; // sample
                document.getElementById('viewGender').textContent = gender;
                document.getElementById('viewEmail').textContent = 'example@email.com';
                document.getElementById('viewContactNo').textContent = '60120000000';
                document.getElementById('viewEmergencyContactNo').textContent = '60120000001';

                openModalAnimated(viewModal);
            });

            // Edit Button
            editBtn.addEventListener('click', () => {
                // Fill edit modal with dummy data (replace with actual fetch if needed)
                document.getElementById('editStudentID').value = studentID;
                document.getElementById('editUsername').value = name;
                document.getElementById('editAge').value = age;
                document.getElementById('editDOB').value = '2005-10-20'; // sample
                document.getElementById('editGender').value = gender;
                document.getElementById('editEmail').value = 'example@email.com';
                document.getElementById('editContactNo').value = '60120000000';
                document.getElementById('editEmergencyContactNo').value = '60120000001';

                openModalAnimated(editModal);
            });
        });

        // View Details buttons inside patient consultation section
        document.querySelectorAll('.viewDetailsBtn').forEach(button => {
            button.addEventListener('click', () => {
                closeModalAnimated(viewModal);
                setTimeout(() => {
                    openModalAnimated(consultationModal);
                }, 300); // slight delay to allow the view modal to close, then open consultation modal with backdrop
            });
        });


        // Save Details button in Edit Modal
        document.getElementById('saveDetailsBtn').addEventListener('click', () => {
            // Here you would typically send the updated data to your server
            // For now, we'll just log the data and close the modal
            const studentID = document.getElementById('editStudentID').value;
            const name = document.getElementById('editUsername').value;
            const age = document.getElementById('editAge').value;
            const dob = document.getElementById('editDOB').value;

            Swal.fire({
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Yes, update it!"
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        title: "Updated!",
                        text: "Your details have been updated.",
                        icon: "success"
                    });
                    console.log('Updated Details:', {
                        studentID,
                        name,
                        age,
                        dob
                    });
                    // Close the modal
                    closeModalAnimated(editModal);
                } else {
                    Swal.fire({
                        title: "Cancelled",
                        text: "Your details are safe :)",
                        icon: "error"
                    });
                    // Close the modal
                    closeModalAnimated(editModal);
                }
            });


        });

        function applyFilters() {
            const gender = document.getElementById('filter-gender').value.toLowerCase();
            const status = document.getElementById('filter-status').value.toLowerCase();
            const fromDate = document.getElementById('filter-visit-from').value;
            const toDate = document.getElementById('filter-visit-to').value;
            const minFrequency = parseInt(document.getElementById('filter-frequency').value) || 0;

            const appointmentRows = document.querySelectorAll('.patient-row');
            let visibleRows = [];

            appointmentRows.forEach(row => {
                let showRow = true;
                const cells = row.querySelectorAll('td');
                const rowStudentId = cells[1].textContent.trim().toLowerCase();
                const rowGender = cells[3].textContent.trim().toLowerCase();
                const rowVisit = cells[4].textContent.trim();
                const rowStatus = cells[5].textContent.trim().toLowerCase();

                if (gender !== 'all gender' && rowGender !== gender) showRow = false;
                if (status !== 'all statuses' && !rowStatus.includes(status)) showRow = false;

                if (fromDate) {
                    const from = new Date(fromDate);
                    const visitDate = new Date(rowVisit);
                    if (visitDate < from) showRow = false;
                }
                if (toDate) {
                    const to = new Date(toDate);
                    const visitDate = new Date(rowVisit);
                    if (visitDate > to) showRow = false;
                }

                const totalVisits = Array.from(appointmentRows).filter(r =>
                    r.querySelectorAll('td')[1].textContent.trim().toLowerCase() === rowStudentId
                ).length;
                if (totalVisits <= minFrequency) showRow = false;

                row.style.display = showRow ? '' : 'none';
                if (showRow) visibleRows.push(row);
            });

            currentPage = 1;
            paginatePatientRows(visibleRows);
        }

        function resetFilters() {
            document.getElementById('filter-form').reset();

            // Reset each individual field if needed
            document.getElementById('filter-gender').selectedIndex = 0;
            document.getElementById('filter-status').selectedIndex = 0;
            document.getElementById('filter-visit-from').value = '';
            document.getElementById('filter-visit-to').value = '';
            document.getElementById('filter-frequency').value = '';

            // Show all rows
            const appointmentRows = document.querySelectorAll('.patient-row');
            appointmentRows.forEach(row => {
                row.style.display = '';
            });
        }

        function openModalAnimated(modalElement) {
            modalElement.classList.remove('d-none');
            customBackdrop.classList.remove('d-none');

            setTimeout(() => {
                modalElement.classList.add('show');
                customBackdrop.classList.add('show');
            }, 10); // slight delay to allow CSS transition
        }

        function closeModalAnimated(modalElement) {
            modalElement.classList.remove('show');

            setTimeout(() => {
                modalElement.classList.add('d-none');
                customBackdrop.classList.add('d-none');
            }, 300); // match the transition duration
        }


    </script>

</body>

</html>